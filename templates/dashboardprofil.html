<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/static/css/dashboardprofil.css">
    <link rel="stylesheet" href="/static/css/sidebars.css">
    <script src="static/js/jquery.js"></script>
    <script src="static/js/sidebars.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</head>


<body>

<main class="d-flex flex-nowrap">
      <div class="position-relative d-flex flex-column flex-shrink-0 p-3 text-bg-black " style="width: 280px;" id="sidenavbar">
        <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-black text-decoration-none">
          <svg class="bi pe-none me-2" width="40" height="32"><use xlink:href="#bootstrap"/></svg>
          <span class="fs-4"><img src="/static/img/icon/logo.png" alt="" class="mb-5"></span>
        </a>
        <ul class="nav nav-pills flex-column mb-auto">
          <li class="nav-item">
          <li>
            <a href="{{url_for('dashboard')}}" class="nav-link text-black">
                <img width="16" height="16" src="/static/img/dashboard/icon/dashboard.svg" alt="">
              Dashboard
            </a>
          </li>
          <li>
            <a href="{{url_for('dashboardpesanan')}}" class="nav-link text-black">
              <img width="16" height="16" src="/static/img/dashboard/icon/pesanan.svg" alt="">
              Pesanan
            </a>
          </li>
          <li>
            <a href="{{url_for('dashboarddaftarharga')}}" class="nav-link text-black">
                <img width="16" height="16" src="/static/img/dashboard/icon/daftarpesanan.svg" alt="">
                Daftar Produk
            </a>
          </li>
          <li>
            <a href="{{url_for('dashboardanalisis')}}" class="nav-link text-black">
                <img width="16" height="16" src="/static/img/dashboard/icon/analisis.svg" alt="">
                Analisis
            </a>
          </li>
          <li>
            <a href="{{url_for('dashboardkeuangan')}}" class="nav-link text-black">
                <img width="16" height="16" src="/static/img/dashboard/icon/totalpendapatan.svg" alt="">
                Keuangan
            </a>
          </li>
          <li >
            <a href="{{url_for('dashboardulasan')}}" class="nav-link text-black">
              <img width="16" height="16" src="/static/img/dashboard/icon/totalpenilaian.svg" alt="">
              Ulasan
            </a>
          </li>
          <li>
            <a href="{{url_for('dashboardcuaca')}}" class="nav-link text-black">
              <img width="16" height="16" src="/static/img/dashboard/icon/cuaca.svg" alt="">
              Cuaca
            </a>
          </li>
          <li>
            <a href="{{url_for('dashboardprogram')}}" class="nav-link text-black">
              <img width="16" height="16" src="/static/img/dashboard/icon/program.svg" alt="">
              Program
            </a>
          </li>
          <hr>
          <li>
            <a href="{{url_for('profil')}}" class="nav-link text-black">
                <img width="16" height="16" src="/static/img/dashboard/icon/beralih.svg" alt="">
              Beralih Ke Akun Pendaki
            </a>
          </li>
          <div class="buttonlogout">
            <a href="{{url_for('logout')}}"><button type="submit" id="logout">Keluar Akun</button></a>
        </div>
        </ul>
      </div>
      <div class="content py-4 px-5" style="background-color: aliceblue; width:1px ;"> 
        <div class="header d-flex justify-content-between align-items-center mb-4">
            <h3>Profil</h3>
            <div class="profil">
                <img src="/static/uploads/profil/{{gambarprofil}}" alt="">
                <h6>{{nama}}</h6>
            </div>
        </div>
        <div class="profil-content mx-auto">
          {% if msgbenar %}
          <p style="color: green;">{{ msgbenar }}</p>
          {% endif %}
          {% if msgsalah %}
          <p style="color: red;">{{ msgsalah }}</p>
          {% endif %}
          <div class="" id="formprofil">
          <h3>Informasi Pribadi</h3>
          <div class="form-content mt-4">
              <div class="fotoprofil">
                  <img src="/static/uploads/profil/{{gambarprofil}}" alt="">
                  <form  action="{{ url_for('dashboardupdatefotoprofil') }}" method="post" enctype="multipart/form-data">
                      <button type="button" id="potoprofil" style="background-color: #ffffff00; border: none; margin: auto; margin: 20px 25px ; text-decoration: underline;">Ubah Foto Profil</button><br>
                      <input type="file" name="fotoprofil" id="uploadfotoprofil" style="display: none;">
                      <button type="submit" id="simpan" style="display: none ;">Simpan</button>
                  </form>
              </div>
              <form  action="{{ url_for('dashboardprofil') }}" method="get" class="">
                  <div class="editprofil-field">
                      <div class="editprofil-content">
                          <div class="fielddata-profil">
                              <h6>Nama</h6>
                              <div class="dataprofil"><h6>{{nama}}</h6></div>
                          </div>
                      </div>
                      <div class="editprofil-content">
                          <div class="fielddata-profil">
                              <h6>Email</h6>
                              <div class="dataprofil"><h6>{{email}}</h6></div>
                          </div>
                      </div>
                      <div class="fielddata-profil-flex">
                          <div class="editprofil-content-flex">
                              <div class="fielddata-profil">
                                  <h6>Tanggal Lahir</h6>
                                  <div class="dataprofil"><h6>{{tanggal_lahir}}</h6></div>
                                  <img src="/s" alt="">
                              </div>
                          </div>
                          <div class="editprofil-content-flex">
                              <div class="fielddata-profil">
                                  <h6>No HP</h6>
                                  <div class="dataprofil"><h6>{{nohp}}</h6></div>
                              </div>
                          </div>
                      </div>
                      <div class="fielddata-profil-flex">
                          <div class="editprofil-content-flex">
                              <div class="fielddata-profil">
                                  <h6>Provinsi</h6>
                                  <div class="dataprofil"><h6>{{provinsi}}</h6></div>
                                  <img src="/s" alt="">
                              </div>
                          </div>
                          <div class="editprofil-content-flex">
                              <div class="fielddata-profil">
                                  <h6>Kabupaten</h6>
                                  <div class="dataprofil"><h6>{{kabupaten}}</h6></div>
                              </div>
                          </div>
                      </div>
                      <div class="fielddata-profil-flex">
                          <div class="editprofil-content-flex">
                              <div class="fielddata-profil">
                                  <h6>Kecamatan</h6>
                                  <div class="dataprofil"><h6>{{kecamatan}}</h6></div>
                                  <img src="/s" alt="">
                              </div>
                          </div>
                          <div class="editprofil-content-flex">
                              <div class="fielddata-profil">
                                  <h6>Kode Pos</h6>
                                  <div class="dataprofil"><h6>{{kode_pos}}</h6></div>
                              </div>
                          </div>
                      </div>
                      <div class="editprofil-content">
                          <div class="fielddata-profil">
                              <h6>Alamat</h6>
                              <div class="dataprofil"><h6>{{alamat}}</h6></div>
                          </div>
                      </div>
                      <div class="fielddata-profil-flex justify-content-end">
                          <div class="editprofil-content-flex">
                              <button type="button" class="btn btn-primary my-3 " id="submitbutton2" onclick="editprofil()" >Edit</button> <br/>
                          </div>
                      </div>
                      </form>
                      <div id="ubahpassword" class="d-none mt-5">
                          <form class="ubahpassword" action="" method="post">
                              <h3>Ubah Kata Sandi</h3>
                              <div class="editpassword-field">
                                  <div class="editpassword-content">
                                      <div class="fielddata-password">
                                          <h6>Kata Sandi Lama</h6>
                                          <h6><input type="password" name="passwordlama" id="passwordlama" oninput="validasipassword()"></h6>
                                          <div class="show-hide" onclick="actionshowhide1()">
                                              <img src="{{ url_for('static', filename='img/icon/hide.svg') }}" alt="" id="show-password1"/>
                                          </div>
                                      </div>
                                      <div class="fielddata-password">
                                          <h6>Kata Sandi Baru</h6>
                                          <h6><input type="password" name="passwordbaru" id="passwordbaru" oninput="validasipassword()"></h6>
                                          <div class="show-hide" onclick="actionshowhide2()">
                                              <img src="{{ url_for('static', filename='img/icon/hide.svg') }}" alt="" id="show-password2"/>
                                              <div class="text-left text-danger" id="msgpassword"></div>
                                          </div>
                                      </div>
                                      <div class="fielddata-password">
                                          <h6>Konfirmasi Sandi Baru</h6>
                                          <h6><input type="password"id='confirmpassword' oninput="checkconfirmpassword()"></h6>
                                          <div class="show-hide" onclick="actionshowhide3()">
                                              <img src="{{ url_for('static', filename='img/icon/hide.svg') }}" alt="" id="show-password3"/>
                                              <div class="text-left text-danger" id="msgconfirmpassword"></div>
                                          </div>
                                      </div>
                                  </div>
                                  <div class="editpassword-content">
                                      <button type="submit" class="btn btn-primary my-3" id="submitbutton4" >Simpan Password</button> <br/>
                                  </div>
                              </div>
                          </form>
                      </div>
                  </div>
              </div>
            </div>

          <!--Edit Profil-->

          <form id="formedit" action="{{ url_for('dashboardprofil') }}" method="post" class="d-none">
              <h3>Informasi Pribadi</h3>
              <div class="form-content mt-4">
                  <div class="fotoprofil">
                    <img src="/static/uploads/profil/{{gambarprofil}}" alt="">
                    <form  action="{{ url_for('dashboardupdatefotoprofil') }}" method="post" enctype="multipart/form-data">
                        <button type="button" id="potoprofil" style="background-color: #ffffff00; border: none; margin: auto; margin: 20px 25px ; text-decoration: underline;">Ubah Foto Profil</button><br>
                        <input type="file" name="fotoprofil" id="uploadfotoprofil" style="display: none;">
                        <button type="submit" id="simpan" style="display: none ;">Simpan</button>
                    </form>
                  </div>
                  <div class="editprofil-field">
                      <div class="editprofil-content">
                          <div class="fielddata-profil">
                              <h6>Nama</h6>
                              <div class="dataprofil" style=" color: #777E90;"><h6>{{nama}}</h6></div>
                          </div>
                      </div>
                      <div class="editprofil-content">
                          <div class="fielddata-profil">
                              <h6>Email</h6>
                              <div class="dataprofil" style=" color: #777E90;"><h6>{{email}}</h6></div>
                          </div>
                      </div>
                      <div class="fielddata-profil-flex">
                          <div class="editprofil-content-flex">
                              <div class="fielddata-profil">
                                  <h6>Tanggal Lahir</h6>
                                  <h6><input type="date" name="tanggal_lahir" value="{{tanggal_lahir}}" ></h6>
                                  <img src="/s" alt="">
                              </div>
                          </div>
                          <div class="editprofil-content-flex">
                              <div class="fielddata-profil">
                                  <h6>No HP</h6>
                                  <h6><input type="number" name="nohp" value="{{nohp}}"></h6>
                              </div>
                          </div>
                      </div>
                      <div class="fielddata-profil-flex">
                          <div class="editprofil-content-flex">
                              <div class="fielddata-profil">
                                  <h6>Provinsi</h6>
                                  <h6><input type="text" name="provinsi" value="{{provinsi}}"></h6>
                                  <img src="/s" alt="">
                              </div>
                          </div>
                          <div class="editprofil-content-flex">
                              <div class="fielddata-profil">
                                  <h6>Kabupaten</h6>
                                  <h6><input type="text" name="kabupaten" value="{{kabupaten}}"></h6>
                              </div>
                          </div>
                      </div>
                      <div class="fielddata-profil-flex">
                          <div class="editprofil-content-flex">
                              <div class="fielddata-profil">
                                  <h6>Kecamatan</h6>
                                  <h6><input type="text" name="kecamatan" value="{{kecamatan}}"></h6>
                                  <img src="/s" alt="">
                              </div>
                          </div>
                          <div class="editprofil-content-flex">
                              <div class="fielddata-profil">
                                  <h6>Kode Pos</h6>
                                  <h6><input type="number" name="kode_pos" value="{{kode_pos}}"></h6>
                              </div>
                          </div>
                      </div>
                      <div class="editprofil-content">
                          <div class="fielddata-profil">
                              <h6>Alamat</h6>
                              <h6><input type="text" name="alamat" value="{{alamat}}"></h6>
                          </div>
                      </div>
                      <div class="fielddata-profil-flex justify-content-end">
                          <div class="editprofil-content-flex">
                              <button type="submit" class="btn btn-primary my-3" id="submitbutton3" >Simpan</button> <br/>
                          </div>
                      </div>
                  </div>
              </div>
          </form>
      </div>
        </div>
      </div>
</main>
</body>
</html>

<script>
  function editpassword() {
      var ubahbutton=document.getElementById('submitbutton1');
      var editbutton=document.getElementById('submitbutton2');
      var formpassword=document.getElementById('ubahpassword');

      if (formpassword.classList.contains('d-none')){
          formpassword.classList.remove('d-none');
          ubahbutton.classList.add('d-none');
          editbutton.classList.add('d-none');
      } else {
          formpassword.classList.add('d-none');
          ubahbutton.classList.remove('d-none');
          editbutton.classList.remove('d-none');
      }
  }

  function actionshowhide1() {
      var password = document.getElementById("passwordlama");
      var img = document.getElementById("show-password1");

      if (password.type=='text') {
          password.type = "password";
          img.src = '/static/img/icon/hide.svg';
      } else {
          password.type = "text";
          img.src = '/static/img/icon/show.svg';
      }
  }
  function actionshowhide2() {
      var password = document.getElementById("passwordbaru");
      var img = document.getElementById("show-password2");

      if (password.type=='text') {
          password.type = "password";
          img.src = '/static/img/icon/hide.svg';
      } else {
          password.type = "text";
          img.src = '/static/img/icon/show.svg';
      }
  }

  function actionshowhide3() {
      var confirmpassword = document.getElementById("confirmpassword");
      var img = document.getElementById("show-password3");

      if (confirmpassword.type=='text') {
          confirmpassword.type = "password";
          img.src = '/static/img/icon/hide.svg';
      } else {
          confirmpassword.type = "text";
          img.src = '/static/img/icon/show.svg';
      }
  }

  function validasipassword(){
      var passwordlama = document.getElementById('passwordlama').value;
      var password = document.getElementById('passwordbaru').value;
      var msgpassword = document.getElementById('msgpassword');
      var msgconfirmpassword = document.getElementById('msgconfirmpassword');
      var buttonsubmit = document.getElementById('submitbutton4');

      if (password.length < 8 && !/[A-Z]/.test(password)) {
        msgpassword.innerHTML = "Password harus memiliki minimal 8 karakter <br> Password harus memiliki minimal satu huruf besar";
        buttonsubmit.disabled = true;
    }
      else if (password.length < 8) {
        msgpassword.innerHTML = "Password harus memiliki minimal 8 karakter";
        buttonsubmit.disabled = true;
    }
      else if (!/[A-Z]/.test(password)) {
        msgpassword.innerHTML = "Password harus memiliki minimal satu huruf besar";
        buttonsubmit.disabled = true;
    }
    else{
      msgpassword.innerHTML = "";
      buttonsubmit.disabled = false;
    }
      if (passwordlama === password) {
          msgconfirmpassword.innerHTML = "Password Tidak Boleh Sama Dengan Password Lama!";
          buttonsubmit.disabled = true;
      }else{
          msgconfirmpassword.innerHTML = "";
          buttonsubmit.disabled = false;
      }
  }

  function checkconfirmpassword(){
      var passwordlama = document.getElementById('passwordlama').value;
      var password = document.getElementById('passwordbaru').value;
      var confirmpassword = document.getElementById('confirmpassword').value;
      var msgconfirmpassword = document.getElementById('msgconfirmpassword');
      var buttonsubmit = document.getElementById('submitbutton4');
    
      if (password != confirmpassword) {
          msgconfirmpassword.innerHTML = "Password Tidak Sama!";
          buttonsubmit.disabled = true;
      }
      else{
          msgconfirmpassword.innerHTML = "";
          buttonsubmit.disabled = false;
      }
      if (confirmpassword === '') {
          msgconfirmpassword.innerHTML = "Password Tidak Boleh Kosong!";
          buttonsubmit.disabled = true;
      }
      else{
          msgconfirmpassword.innerHTML = "";
          buttonsubmit.disabled = false;
      }
  }

  function editprofil(){
  var profil=document.getElementById('formprofil');
  var edit=document.getElementById('formedit');

  if (edit.classList.contains('d-none')){
      edit.classList.remove('d-none');
      profil.classList.add('d-none');
  } else {
      edit.classList.add('d-none')
      profil.classList.remove('d-none')
  }
}


  document.getElementById('potoprofil').addEventListener('click', function() {
      document.getElementById('uploadfotoprofil').click();
  });
  document.getElementById('potoprofil').addEventListener('click', function() {
      document.getElementById('simpan').style.display='block';
  });

</script>